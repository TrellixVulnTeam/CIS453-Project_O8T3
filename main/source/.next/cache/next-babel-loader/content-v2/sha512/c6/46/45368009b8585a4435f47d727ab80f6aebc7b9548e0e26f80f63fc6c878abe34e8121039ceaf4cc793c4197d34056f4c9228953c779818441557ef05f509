{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport GUButton from '@components/control/gu-button';\nimport Loading from '@components/other/loading';\nimport Product from '@components/product';\nimport { handleGetProducts } from '@store/thunk/products';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport styled from 'styled-components';\nimport ShopHeader from './shared/shop-header';\nimport ShopSidebar from './shared/shop-sidebar';\nconst StyledProduct = styled(Product)`\n  margin-bottom: ${20 / 14}rem;\n`;\nconst ButtonContaier = styled.div`\n  text-align: center;\n`;\nconst StyledButton = styled(GUButton)`\n  text-transform: uppercase;\n`;\n\nconst ShopLayout = () => {\n  const dispatch = useDispatch();\n  const {\n    0: currentSort,\n    1: setCurrentSort\n  } = useState('');\n  const {\n    0: currentView,\n    1: setCurrentView\n  } = useState(9);\n  const {\n    0: selectedCategoriesId,\n    1: setSelectedCategoriesId\n  } = useState([]);\n  const {\n    0: priceRange,\n    1: setPriceRange\n  } = useState({\n    minPrice: null,\n    maxPrice: null\n  });\n  const {\n    data,\n    fetching,\n    meta,\n    loadingMore\n  } = useSelector(state => state.product.list);\n  const {\n    0: sortKey,\n    1: sortValue\n  } = useMemo(() => currentSort.split(':'), [currentSort]);\n  useEffect(() => {\n    dispatch(handleGetProducts({\n      _page: 1,\n      _limit: currentView,\n      _sort: sortKey,\n      _order: sortValue,\n      'categories.id_like': selectedCategoriesId.join('|') || null,\n      price_gte: priceRange.minPrice || null,\n      price_lte: priceRange.maxPrice || null\n    }));\n  }, [currentSort, currentView, selectedCategoriesId, priceRange]);\n\n  const onLoadingMore = () => {\n    if (meta && data.length && meta.page < meta.pageCount) {\n      dispatch(handleGetProducts({\n        _limit: currentView,\n        _page: meta.page + 1,\n        _sort: sortKey,\n        _order: sortValue,\n        loadingMore: true,\n        'categories.id_like': selectedCategoriesId.join('|') || null,\n        price_gte: priceRange.minPrice || null,\n        price_lte: priceRange.maxPrice || null\n      }));\n    }\n  };\n\n  return /*#__PURE__*/_jsx(\"div\", {\n    className: \"container\",\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"col-12 col-md-4 col-lg-3\",\n        children: /*#__PURE__*/_jsx(ShopSidebar, {\n          onFilterPrice: ({\n            minPrice,\n            maxPrice\n          }) => setPriceRange({\n            minPrice,\n            maxPrice\n          }),\n          getSelectedCategoriesId: ids => setSelectedCategoriesId(ids)\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"col-12 col-md-8 col-lg-9\",\n        children: [/*#__PURE__*/_jsx(ShopHeader, {\n          getCurrentSort: val => setCurrentSort(val),\n          getCurrentView: val => setCurrentView(val)\n        }), fetching ? /*#__PURE__*/_jsx(Loading, {}) : /*#__PURE__*/_jsx(\"div\", {\n          className: \"shop-content\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"row\",\n            children: data === null || data === void 0 ? void 0 : data.map(product => /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-12 col-sm-6 col-lg-4\",\n              children: /*#__PURE__*/_jsx(StyledProduct, {\n                data: product\n              })\n            }))\n          })\n        }), meta && meta.page < meta.pageCount && /*#__PURE__*/_jsx(ButtonContaier, {\n          children: /*#__PURE__*/_jsx(StyledButton, {\n            disabled: loadingMore,\n            preffix: loadingMore && /*#__PURE__*/_jsx(\"i\", {\n              className: \"fal fa-spinner-third\"\n            }),\n            onClick: onLoadingMore,\n            variant: \"contained\",\n            shape: \"round\",\n            weight: \"bold\",\n            children: \"Load more posts\"\n          })\n        })]\n      })]\n    })\n  });\n};\n\nexport default ShopLayout;","map":null,"metadata":{},"sourceType":"module"}